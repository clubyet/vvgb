<!DOCTYPE html>
<html>
	<head>
		<title>OptikServers</title>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
		<link rel="shortcut icon" href="https://cdn.discordapp.com/attachments/732699649143472161/870765448424222730/icons8-group-of-fruits-96.png">
		<link rel="icon" href="https://cdn.discordapp.com/attachments/732699649143472161/870765448424222730/icons8-group-of-fruits-96.png">
		<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="style.css">
		
		<style>
			body {
				background-color: #181C27;

			}
		</style>
	</head>
	<body>
		<section class="ftco-section">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-md-8 col-lg-5">
                        <div class="login-wrap p-4 p-md-5">
                            <center><h4 id="error" style="color:red;"></h4></center>
                      	<div class="icon d-flex align-items-center justify-content-center">
                          <img style="border-radius:50px;" width="90" height="90" src="icon.ico">
                      	</div>
                      <h3 id="username" class="text-center mb-4"></h3>
					  
					  <h4 class="text-center mb-2" id="coins"></h4>
					  <h4 class="text-center mb-2" id="kh">0.05 / minute</h4>
                      <button type="button" id="button" style="width:100%;" class="btn btn-success rounded px-3">START MINING</button>
					  
					  
					</div>
					
                </div>
            </div>
        </div>
    </section>
	</body>
	<script src="renderer.js"></script>
	<script>
		var mining = false;
		const { ipcRenderer } = require("electron");
		ipcRenderer.invoke("userinfo");
		ipcRenderer.on('user', function (evt, message, coins) {
            document.getElementById("username").innerHTML = message;
			document.getElementById("coins").innerHTML = coins + " Coins";
        });
		ipcRenderer.on('error', function (evt, error) {
			if (error == "MINER_KILLED") {
				if (mining == true) {
				mining = false;
				document.getElementById("button").className = "btn btn-success rounded px-3";
				document.getElementById("button").innerHTML = "START MINING";
				alert("The miner has been killed.");
				}
			}
			else if (error == "XMRig is not downloaded, have you got an Anti-Virus enabled?") {
				if (mining == true) {
					mining = false;
					document.getElementById("button").className = "btn btn-success rounded px-3";
					document.getElementById("button").innerHTML = "START MINING";
					alert(error);

				}
			}
			else {
				alert(error);
			}
		})
		
		setInterval(function () {
			if (mining == true) {
				ipcRenderer.invoke("userinfo");
			}
		}, 30000);
		document.getElementById("button").onclick = function () {
		if (mining == false) {
			ipcRenderer.invoke("start");
			
			document.getElementById("button").className = "btn btn-danger rounded px-3";
			document.getElementById("button").innerHTML = "STOP MINING";
			mining = true;
			alert("Heads up! It may take up to 10 minutes for the miner to start working properly as it is searching for the best algorithm.");
		}
		else {
			
			ipcRenderer.invoke("stop");
			document.getElementById("button").className = "btn btn-success rounded px-3";
			document.getElementById("button").innerHTML = "START MINING";
			mining = false;
			
		}
		}
	</script>
</html>